import cheng/runtime/[mobile,mobile_app]

fn onInit(runtime: MobileRuntimeHandle, windowId: int) =
    android_runtime_queue_event(runtime, "app", "init window=" + $windowId)

fn onEvent(runtime: MobileRuntimeHandle, ev: MobileRuntimeEvent) =
    if ev.kind == mreWindowOpened:
        android_runtime_queue_event(runtime, "app", "window opened")
    elif ev.kind == mreFrameTick:
        android_runtime_trace(runtime, "frame", 1.0)

fn onFrame(runtime: MobileRuntimeHandle) =
    android_runtime_trace(runtime, "tick", 1.0)

fn onShutdown(runtime: MobileRuntimeHandle) =
    android_runtime_queue_event(runtime, "app", "shutdown")

fn main() =
    var cfg = defaultMobileAppConfig(mpAndroid)
    cfg.title = "Cheng Mobile Hello"
    var cb = defaultMobileAppCallbacks()
    cb.onInit = onInit
    cb.onEvent = onEvent
    cb.onFrame = onFrame
    cb.onShutdown = onShutdown
    let summary = runMobileApp(cfg, cb, 3)
    echo summary
