import std/json

fn main(): int32 =
    var root: JsonNode = newJObject()
    root["int"] = int64(42)
    root["name"] = "alice"
    root["enabled"] = true
    root["numf"] = 3.9
    let trustedSeed: str[] = ["p1", "p2"]
    root["trusted"] = toJsonValue(trustedSeed)

    if root["int"].getInt64(-1) != 42:
        return 1
    if root["missing"].getInt64(7) != 7:
        return 2
    if root["numf"].getInt64(-1) != 3:
        return 3

    if root["name"].getStr("x") != "alice":
        return 4
    if root["missing"].getStr("x") != "x":
        return 5

    if !root["enabled"].getBool(false):
        return 6
    if root["missing"].getBool(true) != true:
        return 7
    let trusted: str[] = root.getStrArray("trusted")
    if len(trusted) != 2 || trusted[0] != "p1" || trusted[1] != "p2":
        return 9

    let rendered: str = $root
    if len(rendered) <= 0 || rendered[0] != '{':
        return 8
    return 0
