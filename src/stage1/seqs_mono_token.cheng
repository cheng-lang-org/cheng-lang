# Stage1: seq[Token] monomorphized (for bootstrap).
type
    seq_Token =
        len: int32
        cap: int32
        buffer: void*
fn newSeq_Token(len: int32, cap: int32): seq_Token =
    var seqInstance: seq_Token
    seqInstance.len = 0
    seqInstance.cap = cap
    if cap > 0:
        var size64: int64 = int64(cap) * sizeof Token
        var size32: int32 = int32(size64)
        seqInstance.buffer = alloc size32
    else:
        seqInstance.buffer = nil
        return seqInstance
fn get_Token(seqInst: seq_Token, i: int32): Token =
    var idx64: int64 = int64(i)
    var offset64: int64 = idx64 * sizeof Token
    var offset32: int32 = int32(offset64)
    var p: void* = ptr_add(seqInst.buffer, offset32)
    var pt: Token* = Token* p
    return *pt
fn addPtr_Token(seqInst: seq_Token*, val: Token) =
    if seqInst->len >= seqInst->cap:
        var newCap: int32 = 4
        if seqInst->cap != 0:
            newCap = seqInst->cap * 2
            seqInst->cap = newCap
            var cap64: int64 = int64(newCap)
            var size64: int64 = int64(cap64) * sizeof Token
            var size32: int32 = int32(size64)
            seqInst->buffer = realloc(seqInst->buffer, size32)
            var idx64: int64 = int64(seqInst->len)
            var offset64: int64 = int64(idx64) * sizeof Token
            var offset32: int32 = int32(offset64)
            var p: void* = ptr_add(seqInst->buffer, offset32)
            var pt: Token* = Token* p
            *pt = val
            seqInst->len = seqInst->len + 1
