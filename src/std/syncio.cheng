# std/syncio (minimal, pure Cheng)
import std/os
import std/strings

var stdin = get_stdin()
var stdout = get_stdout()
var stderr = get_stderr()

fn readFile(path: str): str =
    let f: File = open(path, fmRead)
    let content = readAll f
    close f
    return content

fn readLine(f: File, line: var str): bool =
    let empty = ""
    if f == nil:
        line = empty
        return false
    var buf = ""
    var saw = false
    while true:
        let c = c_fgetc f
        if c < 0:
            break
        if c == int32('\n'):
            saw = true
            break
        buf = buf + charToStr char(c)
        saw = true
    line = buf
    return saw

fn write(f: File, s: str) =
    0
    c_fwrite(s, 1, len s, f)

fn writeLine(f: File, s: str) =
    write(f, s)
    write(f, "\n")

fn flushFile(f: File) =
    0
    c_fflush f
